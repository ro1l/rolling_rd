"use strict";(self["webpackChunkrolling"]=self["webpackChunkrolling"]||[]).push([[275],{5679:function(t,a,o){function e(t){return{all:t=t||new Map,on:function(a,o){var e=t.get(a);e?e.push(o):t.set(a,[o])},off:function(a,o){var e=t.get(a);e&&(o?e.splice(e.indexOf(o)>>>0,1):t.set(a,[]))},emit:function(a,o){var e=t.get(a);e&&e.slice().map((function(t){t(o)})),(e=t.get("*"))&&e.slice().map((function(t){t(a,o)}))}}}o.d(a,{Z:function(){return c}});const r=e();var c=r},7587:function(t,a,o){var e=o(5679);a.Z=(t,a="更新")=>{const o="string"===typeof t.data.message?[t.data.message]:t.data.message;t.data.success?e.Z.emit("push-message",{style:"success",title:`${a}成功`,content:o.toString()}):e.Z.emit("push-message",{style:"danger",title:`${a}失敗`,content:o.join("、")})}},4677:function(t,a,o){var e=o(7587),r=o(5679),c=o(6154),n=o(9876),i=o(6294);const s=(0,i.Z)();a.Z=(0,n.Q_)("cartStore",{state:()=>({cartProducts:{},cartProductsData:[],status:{loadingItem:""}}),actions:{async addCart(t){s.cartLoadingItem=t;const a="https://vue3-course-api.hexschool.io/api/je-api/cart",o={product_id:t,qty:1};try{const t=await c.Z.post(a,{data:o});s.cartLoadingItem="",(0,e.Z)(t),r.Z.emit("updateCart")}catch(n){console.error("Error 找不到資料",n)}},async getCartProducts(){const t="https://vue3-course-api.hexschool.io/api/je-api/cart";try{const a=await c.Z.get(t);this.cartProducts=a.data.data,this.cartProductsData=a.data.data.carts}catch(a){console.error("Error 找不到資料",a)}},async updateCart(t,a){s.isLoadingForStore=!0,s.cartLoadingItem=t.id;const o=`https://vue3-course-api.hexschool.io/api/je-api/cart/${t.id}`,n={product_id:t.product_id,qty:a};try{const t=await c.Z.put(o,{data:n});s.isLoadingForStore=!1,s.cartLoadingItem="",this.getCartProducts(),(0,e.Z)(t),r.Z.emit("updateCart")}catch(i){console.error("Error 找不到資料",i)}},async delProduct(t){s.cartLoadingItem=t,s.isLoadingForStore=!0;const a=`https://vue3-course-api.hexschool.io/api/je-api/cart/${t}`;try{const t=await c.Z["delete"](a);s.isLoadingForStore=!1,s.cartLoadingItem="",this.getCartProducts(),(0,e.Z)(t),r.Z.emit("updateCart")}catch(o){console.error("Error 找不到資料",o)}},async addCouponCode(t){s.isLoadingForStore=!0;const a="https://vue3-course-api.hexschool.io/api/je-api/coupon",o={code:t};let r;try{r=await c.Z.post(a,{data:o}),s.isLoadingForStore=!1,this.getCartProducts()}catch(n){console.error("Error 找不到資料",n)}finally{(0,e.Z)(r)}},scrollToTop(){window.scrollTo({top:0,behavior:"smooth"})}}})},6294:function(t,a,o){var e=o(9876);a.Z=(0,e.Q_)("statusStore",{state:()=>({isLoadingForStore:!1,cartLoadingItem:""})})},6129:function(t,a,o){o.d(a,{Z:function(){return d}});var e=o(6252),r=o(3577);const c={class:"page-title-lg"};function n(t,a,o,n,i,s){return(0,e.wg)(),(0,e.iD)("div",c,[(0,e._)("h3",null,(0,r.zw)(o.title),1)])}var i={props:{title:String}},s=o(3744);const l=(0,s.Z)(i,[["render",n]]);var d=l},9275:function(t,a,o){o.r(a),o.d(a,{default:function(){return Y}});var e=o(6252),r=o(3577),c=o(9963);const n={class:"cart-box"},i={class:"cart-info"},s={class:"item1 img-box"},l=["src","alt"],d={class:"item2"},u={class:"item3 control-num"},p=["onClick","disabled"],g=(0,e._)("i",{class:"bi bi-dash text-deep"},null,-1),m=[g],h=["onUpdate:modelValue","onChange","disabled"],y=["onClick"],_=(0,e._)("i",{class:"bi bi-plus text-deep"},null,-1),f=[_],v={key:0,class:"item4"},w=["onClick","disabled"],C=(0,e._)("ins",null,"移除購物車",-1),k=[C],b={class:"item6"},P={key:0},Z={key:1},L={class:"total-box"},x={key:0},$=(0,e._)("i",{class:"bi bi-dash"},null,-1),I={key:1},S={class:"checkout"},D={class:"coupon"},q=(0,e._)("label",{for:"coupon",class:"text-deep"},"優惠代碼",-1),T=(0,e._)("small",{class:"text-danger py-2"}," 新人禮：輸入rolling打99折 ",-1),U={key:1,class:"cart-no-data"},z=(0,e._)("h2",null,"購物車暫無商品",-1);function F(t,a,o,g,_,C){const F=(0,e.up)("PageTitle"),j=(0,e.up)("router-link"),N=(0,e.up)("Loading");return(0,e.wg)(),(0,e.iD)(e.HY,null,[(0,e.Wm)(F,{title:"購物車"}),(0,e._)("div",n,[0!==t.cartProducts.total?((0,e.wg)(),(0,e.iD)(e.HY,{key:0},[(0,e._)("div",i,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(t.cartProducts.carts,(a=>((0,e.wg)(),(0,e.iD)("div",{class:"cart-item",key:a.id},[(0,e._)("div",s,[(0,e._)("img",{src:a.product.imageUrl,alt:a.product.title},null,8,l)]),(0,e._)("div",d,[(0,e._)("p",null,(0,r.zw)(a.product.category),1),(0,e._)("p",null,(0,r.zw)(a.product.title),1)]),(0,e._)("div",u,[(0,e._)("button",{type:"button",onClick:(0,c.iM)((o=>t.updateCart(a,a.qty-1)),["prevent"]),disabled:1===a.qty&&a.id===t.cartLoadingItem.loadingItem},m,8,p),(0,e.wy)((0,e._)("input",{type:"number",name:"",id:"qty",min:"1","onUpdate:modelValue":t=>a.qty=t,onChange:o=>t.updateCart(a,a.qty),disabled:a.id===t.cartLoadingItem.loadingItem},null,40,h),[[c.nr,a.qty,void 0,{number:!0}]]),(0,e._)("button",{type:"button",onClick:(0,c.iM)((o=>t.updateCart(a,a.qty+1)),["prevent"])},f,8,y)]),a.coupon?((0,e.wg)(),(0,e.iD)("p",v,' "已套用'+(0,r.zw)(a.coupon.code)+'優惠券" ',1)):(0,e.kq)("",!0),(0,e._)("a",{href:"#",class:"item5 text-deep",onClick:(0,c.iM)((o=>t.delProduct(a.id)),["prevent"]),disabled:a.id===t.cartLoadingItem.loadingItem},k,8,w),(0,e._)("div",b,[a.coupon?((0,e.wg)(),(0,e.iD)("h5",Z,[(0,e._)("del",null,"NT$"+(0,r.zw)(t.$filters.currency(a.total)),1),(0,e.Uk)(" NT$"+(0,r.zw)(t.$filters.currency(a.final_total)),1)])):((0,e.wg)(),(0,e.iD)("h5",P,"NT$"+(0,r.zw)(t.$filters.currency(a.total)),1))])])))),128)),(0,e._)("div",L,[(0,e._)("p",null,[(0,e.Uk)(" 總金額 "),(0,e._)("span",null,"NT$"+(0,r.zw)(t.$filters.currency(t.cartProducts.total)),1)]),t.cartProducts.total!==t.cartProducts.final_total?((0,e.wg)(),(0,e.iD)("p",x,[(0,e.Uk)(" 折扣 "),(0,e._)("span",null,[$,(0,e.Uk)(" NT$"+(0,r.zw)(t.$filters.currency(t.cartProducts.total-t.cartProducts.final_total)),1)])])):(0,e.kq)("",!0),t.cartProducts.total!==t.cartProducts.final_total?((0,e.wg)(),(0,e.iD)("p",I,[(0,e.Uk)(" 最終金額 "),(0,e._)("span",null," NT$"+(0,r.zw)(t.$filters.currency(t.cartProducts.final_total)),1)])):(0,e.kq)("",!0)])]),(0,e._)("div",S,[(0,e._)("div",D,[q,T,(0,e.wy)((0,e._)("input",{type:"text",name:"",id:"coupon",placeholder:"請輸入優惠券代碼","onUpdate:modelValue":a[0]||(a[0]=t=>_.couponCode=t),onChange:a[1]||(a[1]=a=>t.addCouponCode(_.couponCode))},null,544),[[c.nr,_.couponCode]])]),(0,e.Wm)(j,{to:{name:"訂單填寫"},class:"border-btn"},{default:(0,e.w5)((()=>[(0,e.Uk)(" 訪客結帳 ")])),_:1})])],64)):((0,e.wg)(),(0,e.iD)("div",U,[z,(0,e.Wm)(j,{to:{name:"所有產品"},class:"border-btn text-deep"},{default:(0,e.w5)((()=>[(0,e.Uk)(" 前往選購 ")])),_:1})]))]),(0,e.Wm)(N,{active:t.isLoadingForStore},null,8,["active"])],64)}var j=o(6129),N=o(9876),E=o(4677),M=o(6294),W={components:{PageTitle:j.Z},data(){return{min:1,max:10,couponCode:""}},computed:{...(0,N.rn)(E.Z,["cartProducts"]),...(0,N.rn)(M.Z,["isLoadingForStore","cartLoadingItem"])},methods:{...(0,N.nv)(E.Z,["getCartProducts","updateCart","delProduct","addCouponCode"])},created(){this.getCartProducts(),window.scrollTo(0,0)},inject:["emitter","pushMessageState"]},H=o(3744);const V=(0,H.Z)(W,[["render",F]]);var Y=V}}]);
//# sourceMappingURL=275.91a6217a.js.map